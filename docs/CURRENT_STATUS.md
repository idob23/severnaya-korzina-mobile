# –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ "–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–∑–∏–Ω–∞"

## üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 22 –∞–≤–≥—É—Å—Ç–∞ 2025

## üéØ –¢–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞
**üîÑ –í –ü–†–û–¶–ï–°–°–ï: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è webhook'–æ–≤ –ÆKassa**

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤ —Å `pending` –Ω–∞ `paid` —á–µ—Ä–µ–∑ webhook'–∏ –ÆKassa.

## üîÑ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–≤ —ç—Ç–æ–º —á–∞—Ç–µ)

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —á–∞—Ç–∞—Ö:
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –∫ –∑–∞–∫—É–ø–∫–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç
2. **–ê–¥–º–∏–Ω–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π** - —Ä–∞–±–æ—Ç–∞–µ—Ç  
3. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∑–∞–∫—É–ø–æ–∫** - —Ä–∞–±–æ—Ç–∞–µ—Ç
4. **–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤** - —É–±—Ä–∞–Ω –ª–∏—à–Ω–∏–π —Å—Ç–∞—Ç—É—Å `confirmed`
5. **–î–µ—Ç–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω –ø–∞—Ä—Ç–∏–∏** - —Å–æ–∑–¥–∞–Ω `BatchDetailsScreen` —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

### üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ (—Ç–µ–∫—É—â–∏–π —á–∞—Ç):
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –ÆKassa –∑–∞–∫–∞–∑—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å–µ `pending`, –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ `paid`
**–ü—Ä–∏—á–∏–Ω–∞:** –ÆKassa —Ç—Ä–µ–±—É–µ—Ç HTTPS –¥–ª—è webhook'–æ–≤, –∞ API —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ –ø–æ HTTP
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è API

#### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
1. **SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω** - Let's Encrypt –¥–ª—è `api.sevkorzina.ru`
2. **Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω** - reverse proxy HTTPS ‚Üí HTTP:3000
3. **API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS** - `https://api.sevkorzina.ru/health` —Ä–∞–±–æ—Ç–∞–µ—Ç
4. **–ü–æ–¥–¥–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω** - DNS A-–∑–∞–ø–∏—Å—å `api.sevkorzina.ru ‚Üí 84.201.149.245`

#### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é:
1. **Webhook URL –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –ÆKassa** - `https://api.sevkorzina.ru/api/payments/webhook`
2. **–õ–æ–≥–∏–∫–∞ webhook'–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞** - –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∑–∞–∫–∞–∑ –Ω–∞ `paid`
3. **–ú–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω** - —Ç–µ—Å—Ç–æ–≤—ã–π webhook —Ä–∞–±–æ—Ç–∞–µ—Ç, –∑–∞–∫–∞–∑ #56 —Å—Ç–∞–ª `paid`

### üîÑ –û—Å—Ç–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å:
**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ** - API `admin-batches` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É "–°–æ–±—Ä–∞–Ω–æ"

### üìÅ –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- `src/routes/auth.js` - —Ñ—É–Ω–∫—Ü–∏—è `admin-batches` (–∫–æ–¥ –≥–æ—Ç–æ–≤ –¥–ª—è –∑–∞–º–µ–Ω—ã)

## üöÄ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ:
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ö–∞—Ç–∞–ª–æ–≥**: –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
- **–ö–æ—Ä–∑–∏–Ω–∞**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º, —Ä–∞—Å—á–µ—Ç —Å—É–º–º—ã
- **–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞**: CheckoutScreen —Å –≤—ã–±–æ—Ä–æ–º –∞–¥—Ä–µ—Å–∞
- **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤**: –ó–∞–∫–∞–∑—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`
- **–ê–≤—Ç–æ–ø—Ä–∏–≤—è–∑–∫–∞ –∫ –ø–∞—Ä—Ç–∏—è–º**: –ó–∞–∫–∞–∑—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∞–∫—Ç–∏–≤–Ω—É—é –∑–∞–∫—É–ø–∫—É
- **–ê–¥–º–∏–Ω–∫–∞**: 
  - –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–∞—Ä—Ç–∏–π —Å –∑–∞–∫–∞–∑–∞–º–∏
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤
  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –∑–∞–∫—É–ø–æ–∫
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤)

### üîÑ –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **–ü–ª–∞—Ç–µ–∂–∏ –∏ webhook'–∏**: Webhook –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ –∞–¥–º–∏–Ω–∫–µ
- **–ü–æ–ª–µ "–°–æ–±—Ä–∞–Ω–æ"**: Backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É (20300‚ÇΩ), –Ω–æ –∞–¥–º–∏–Ω–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (2240‚ÇΩ)

## üêõ –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (–ø–æ—á—Ç–∏ —Ä–µ—à–µ–Ω–∞)

**Webhook'–∏ —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ –∞–¥–º–∏–Ω–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—É–º–º—É:**
- –ó–∞–∫–∞–∑—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending` ‚úÖ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ –ÆKassa ‚úÖ  
- Webhook –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `paid` ‚úÖ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ)
- Backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ ‚úÖ (20300‚ÇΩ –≤ –ª–æ–≥–∞—Ö)
- –ê–¥–º–∏–Ω–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—É–º–º—É ‚ùå (2240‚ÇΩ –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

**–ü—Ä–∏—á–∏–Ω–∞:** API `admin-batches` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É –ø–æ–¥—Å—á–µ—Ç–∞ —Å—É–º–º

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–æ–º–µ–Ω–æ–≤

- **`sevkorzina.ru`** (31.31.197.13) - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç —Å SSL
- **`app.sevkorzina.ru`** (–±–µ–∑ SSL) - –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è iOS
- **`api.sevkorzina.ru`** (84.201.149.245) - API —Å SSL –¥–ª—è webhook'–æ–≤ ‚úÖ
- **Backend API:** Node.js –Ω–∞ –ø–æ—Ä—Ç—É 3000
- **Nginx:** reverse proxy HTTPS:443 ‚Üí HTTP:3000

## üìã –°–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 - –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ:
1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å API admin-batches** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç —Å—É–º–º –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** - "–°–æ–±—Ä–∞–Ω–æ" –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 20300‚ÇΩ –≤–º–µ—Å—Ç–æ 2240‚ÇΩ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 - –î–æ–∂–¥–∞—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω—ã—Ö webhook'–æ–≤:
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ÆKassa** - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ webhook URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏** - –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Ö–æ–¥–∏—Ç—å webhook'–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 - –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–¥–º–∏–Ω–∫–∏:
1. **–ö–Ω–æ–ø–∫–∏ "–ú–∞—à–∏–Ω–∞ —É–µ—Ö–∞–ª–∞/–ø—Ä–∏–µ—Ö–∞–ª–∞"** - –º–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –ø–∞—Ä—Ç–∏–∏
2. **SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–æ–≤
3. **–ö–Ω–æ–ø–∫–∞ "–û—Ç–∫–∞—Ç–∏—Ç—å –ø–∞—Ä—Ç–∏—é"** - –≤–æ–∑–≤—Ä–∞—Ç –¥–µ–Ω–µ–≥

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 - –ü—Ä–æ–¥–∞–∫—à–Ω –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:
1. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ÆKassa –Ω–∞ –±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º**
2. **End-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã**

## üí° –ó–∞–º–µ—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏ –Ω–∞—á–∞–ª–µ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
> "–ü—Ä–∏–≤–µ—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–∑–∏–Ω–∞. –û–∑–Ω–∞–∫–æ–º—å—Å—è —Å PROJECT_OVERVIEW.md –∏ CURRENT_STATUS.md. HTTPS –¥–ª—è webhook'–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ú–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω. –û—Å—Ç–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å API admin-batches –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—É–º–º –≤ –∞–¥–º–∏–Ω–∫–µ."

### –°—Ç–∞—Ç—É—Å webhook'–æ–≤:
- SSL –∏ HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã: `https://api.sevkorzina.ru/api/payments/webhook`
- –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ `src/routes/payments.js`
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- –ó–∞–∫–∞–∑ #56 —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω —Å `pending` –Ω–∞ `paid`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è webhook'–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
curl -X POST https://api.sevkorzina.ru/api/payments/webhook \
  -H "Content-Type: application/json" \
  -d '{"event": "payment.succeeded", "object": {"id": "test", "status": "succeeded", "metadata": {"order_id": "–ù–û–ú–ï–†_–ó–ê–ö–ê–ó–ê"}}}'
```

---

**–í–∞–∂–Ω–æ**: Webhook'–∏ - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª. –ë–µ–∑ –Ω–∏—Ö –∑–∞–∫–∞–∑—ã –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –≤ —Å—Ç–∞—Ç—É—Å "–æ–ø–ª–∞—á–µ–Ω–æ" –∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.