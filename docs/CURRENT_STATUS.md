# üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ "–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–∑–∏–Ω–∞"

## üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 31 –¥–µ–∫–∞–±—Ä—è 2024

## üéØ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
**üèÜ –ü–†–û–ï–ö–¢ –í –ü–†–û–î–ê–ö–®–ï–ù–ï**

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –±–æ–µ–≤–æ–º —Ä–µ–∂–∏–º–µ.

## ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–¥–µ–∫–∞–±—Ä—å 2024)

### üÜï –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π Android:
1. **API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–π** ‚úÖ
   - Endpoint `/api/app/version` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±—ã—á–Ω—ã—Ö –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
   - Changelog –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—Å–∏–∏

2. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** ‚úÖ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
   - –ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∞–ª–æ–≥ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
   - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∑–∞–≥—Ä—É–∑–∫–∏ APK
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Android Package Installer

3. **UpdateService** ‚úÖ
   - –°–∏–Ω–≥–ª—Ç–æ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–µ—Ä—Å–∏—è—Ö
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–æ–∂–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ N –¥–Ω–µ–π

### üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–µ–∫–∞–±—Ä—å 2024):
1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ —Ä–µ—à–µ–Ω–∞** ‚úÖ
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `Foreign key constraint violated: orders_addressId_fkey`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤

2. **Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞** ‚úÖ
   - –ó–∞—â–∏—Ç–∞ –æ—Ç NaN –≤ `parseInt(metadata.order_id)`
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

3. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤–µ–±-–≤–µ—Ä—Å–∏–∏** ‚úÖ
   - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ö–æ–¥–∞ –∫—ç—à–∞
   - Service Worker —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
   - PowerShell —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è)

```
üì± –ú–û–ë–ò–õ–¨–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï (Flutter 3.0+)
‚îú‚îÄ‚îÄ üîê SMS –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üõí –ö–∞—Ç–∞–ª–æ–≥ –∏ –∑–∞–∫–∞–∑—ã  
‚îú‚îÄ‚îÄ üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ÆKassa
‚îú‚îÄ‚îÄ üì± Push/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ üîÑ OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (NEW!)

üåê –í–ï–ë-–ü–†–ò–õ–û–ñ–ï–ù–ò–ï (Flutter Web)
‚îú‚îÄ‚îÄ üì± PWA –¥–ª—è iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤
‚îú‚îÄ‚îÄ üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ üì≤ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
‚îî‚îÄ‚îÄ ‚ö° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π

üîß –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê (Flutter Web)  
‚îú‚îÄ‚îÄ üìä Dashboard —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
‚îú‚îÄ‚îÄ üöõ "–ú–∞—à–∏–Ω–∞ —É–µ—Ö–∞–ª–∞/–ø—Ä–∏–µ—Ö–∞–ª–∞"
‚îú‚îÄ‚îÄ üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îú‚îÄ‚îÄ üí¨ SMS —Ä–∞—Å—Å—ã–ª–∫–∏
‚îî‚îÄ‚îÄ üì± –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

üóÑÔ∏è BACKEND API (Node.js + Express)
‚îú‚îÄ‚îÄ üîÑ REST API (–≤—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç)
‚îú‚îÄ‚îÄ üíæ PostgreSQL + Prisma ORM
‚îú‚îÄ‚îÄ üîó –ÆKassa webhook
‚îú‚îÄ‚îÄ üì≤ SMS-—Å–µ—Ä–≤–∏—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ üì± API –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å |
|-----------|---------|-------------|
| **Backend API** | ‚úÖ –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ | 100% |
| **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** | ‚úÖ –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ | 100% |
| **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** | ‚úÖ –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ | 100% |
| **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å** | ‚úÖ –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ | 100% |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | ‚úÖ –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ | 100% |
| **–ü–ª–∞—Ç–µ–∂–∏** | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | 100% |
| **SMS** | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | 100% |
| **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Android** | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | 100% |
| **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Web** | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | 100% |

## üì± –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ–∫—É—â–∏–µ –≤–µ—Ä—Å–∏–∏:
- **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: 1.2.0 (build 12)
- **Backend API**: 1.0.0
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: 6.12281441
- **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**: 1.0.0

### –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- **1.2.0** (31.12.2024) - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **1.1.0** (20.12.2024) - –£–ª—É—á—à–µ–Ω–∏—è UI/UX
- **1.0.0** (01.12.2024) - –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:
1. –ò–∑–º–µ–Ω–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ `pubspec.yaml`
2. –°–æ–±—Ä–∞—Ç—å APK: `flutter build apk --release`
3. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å: `severnaya-korzina-X.Y.Z.apk`
4. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ `/public/downloads/`
5. –û–±–Ω–æ–≤–∏—Ç—å `src/routes/app.js`
6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä: `pm2 restart all`

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
2. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
3. –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –∑–∞–≥—Ä—É–∑–∫–∏
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

## üöÄ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–µ—Ä (Yandex Cloud):
- **IP**: 84.201.149.245
- **OS**: Ubuntu 22.04 LTS
- **RAM**: 4 GB
- **CPU**: 2 vCPU
- **Disk**: 50 GB SSD

### Endpoints:
- **API**: http://84.201.149.245:3000/api
- **Web App**: http://84.201.149.245:3000/app
- **Admin**: http://84.201.149.245:3000/admin
- **APK Downloads**: http://84.201.149.245:3000/downloads

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- **PM2**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- **Nginx**: –ü—Ä–æ–∫—Å–∏ –∏ —Å—Ç–∞—Ç–∏–∫–∞
- **Logs**: `/var/log/nginx/` –∏ `pm2 logs`

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: ~100+
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫—É–ø–æ–∫**: 2-3 –≤ –º–µ—Å—è—Ü
- **–°—Ä–µ–¥–Ω–∏–π —á–µ–∫**: 3000-5000 ‚ÇΩ
- **–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –∑–∞–∫–∞–∑**: ~40%

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
- **Backend**:
  - `src/server.js` - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞
  - `src/routes/app.js` - API –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  - `prisma/schema.prisma` - —Å—Ö–µ–º–∞ –ë–î
  
- **Mobile**:
  - `lib/services/update_service.dart` - —Å–µ—Ä–≤–∏—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  - `lib/main.dart` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
  - `pubspec.yaml` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –≤–µ—Ä—Å–∏—è

- **Deployment**:
  - `deploy_with_cleanup.ps1` - –¥–µ–ø–ª–æ–π –≤–µ–±-–≤–µ—Ä—Å–∏–∏
  - `Dockerfile` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
  - `.env` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìã TODO (–±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è)

- [ ] Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ FCM
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°
- [ ] –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- [ ] –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- [ ] –ß–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- [ ] iOS –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üéâ –ò—Ç–æ–≥–∏ 2024 –≥–æ–¥–∞

**–ü—Ä–æ–µ–∫—Ç "–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–∑–∏–Ω–∞" —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!**

- ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ—Ç –∑–∞–∫–∞–∑–∞ –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–≤–æ–ª—å–Ω—ã —Å–µ—Ä–≤–∏—Å–æ–º
- ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—é—Ç –∑–∞–∫—É–ø–∫–∞–º–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

---

**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: –ü—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞! üöÄ