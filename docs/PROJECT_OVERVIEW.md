# 🛒 Северная Корзина - Платформа коллективных закупок

## 📋 Обзор проекта

**Северная Корзина** - комплексная экосистема для организации коллективных закупок в г. Усть-Нера (Республика Саха, Якутия), обеспечивающая экономию до 50% от розничных цен за счет объединения заказов жителей.

## 🏗️ Архитектура системы

```
┌─────────────────────────────────────────────────────────────────┐
│                    ЭКОСИСТЕМА ПРОЕКТА                          │
├─────────────────────────────────────────────────────────────────┤
│  📱 МОБИЛЬНОЕ ПРИЛОЖЕНИЕ (Flutter 3.0+)                        │
│  ├─ Каталог товаров с поиском и фильтрацией                   │
│  ├─ Корзина с управлением количеством                          │
│  ├─ Онлайн оплата через ЮKassa (тестовый режим)              │
│  ├─ SMS-авторизация и регистрация                              │
│  ├─ Управление адресами доставки                               │
│  ├─ История заказов с отслеживанием статусов                  │
│  ├─ Профиль пользователя с инструкциями                        │
│  ├─ Система OTA-обновлений с проверкой версий                 │
│  └─ Прогресс-трекер закупок в реальном времени                │
├─────────────────────────────────────────────────────────────────┤
│  🌐 ВЕБ-ПРИЛОЖЕНИЕ (Flutter Web PWA)                           │
│  ├─ Адаптивный интерфейс для всех устройств                   │
│  ├─ PWA функциональность для iOS                              │
│  ├─ Автоматическое обновление через Service Worker            │
│  ├─ Универсальная платежная система                            │
│  └─ Система принудительных обновлений версий                  │
├─────────────────────────────────────────────────────────────────┤
│  🔧 ПАНЕЛЬ АДМИНИСТРАТОРА (Flutter Web)                        │
│  ├─ Dashboard со статистикой в реальном времени                │
│  ├─ Управление товарами (CRUD + категории)                    │
│  ├─ Управление закупками/партиями                              │
│  ├─ Управление пользователями (активация/деактивация)         │
│  ├─ Логистика: "Машина уехала/приехала"                       │
│  ├─ SMS-рассылки и уведомления                                 │
│  ├─ Детальный просмотр заказов в партиях                      │
│  ├─ Общий заказ для поставщика (агрегация)                    │
│  └─ Группировка заказов по пользователям                      │
├─────────────────────────────────────────────────────────────────┤
│  🗄️ BACKEND API (Node.js + Express + PostgreSQL)              │
│  ├─ RESTful API с JWT авторизацией                             │
│  ├─ PostgreSQL через Prisma ORM                                │
│  ├─ Webhook интеграция с ЮKassa                                │
│  ├─ SMS-сервис (SMS Aero)                                      │
│  ├─ Система версионирования и обновлений                       │
│  ├─ Автоматические расчеты партий                              │
│  ├─ Каскадное удаление связанных данных                        │
│  └─ PM2 для управления процессами                              │
└─────────────────────────────────────────────────────────────────┘
```

## 🎯 Цели и задачи проекта

### Основная цель
Создание доступной платформы для организации коллективных закупок в условиях отдаленного северного города с целью снижения стоимости товаров первой необходимости.

### Решаемые задачи:
- **Для жителей**: Доступ к товарам по оптовым ценам
- **Для организаторов**: Автоматизация процесса закупок
- **Для поставщиков**: Гарантированные объемы заказов
- **Для логистики**: Оптимизация доставки в труднодоступные районы

## 📊 Функциональные возможности

### Для пользователей:
- 🛍️ **Каталог товаров**
  - Поиск по названию
  - Фильтрация по категориям
  - Отображение остатков
  - Детальная информация о товарах
  
- 🛒 **Корзина и заказы**
  - Управление количеством товаров
  - Расчет итоговой стоимости
  - Сохранение корзины между сессиями
  - История всех заказов
  
- 💳 **Платежная система**
  - Интеграция с ЮKassa
  - Безопасная оплата банковскими картами
  - Автоматическое подтверждение платежей
  - Webhook обработка статусов
  
- 📱 **Мобильные функции**
  - SMS-авторизация
  - Push-уведомления о статусах
  - Автоматические обновления
  - Офлайн-режим для просмотра

### Для администраторов:
- 📊 **Аналитика и статистика**
  - Количество пользователей
  - Объем продаж
  - Популярные товары
  - Статистика по партиям
  
- 📦 **Управление закупками**
  - Создание и редактирование партий
  - Установка целевых сумм
  - Контроль сроков
  - Автоматический запуск при достижении минимума
  
- 🚛 **Логистические функции**
  - Отметка отправки товаров
  - Отметка прибытия
  - SMS-уведомления участникам
  - Формирование общего заказа поставщику
  
- 👥 **Управление пользователями**
  - Просмотр профилей
  - Активация/деактивация аккаунтов
  - История заказов пользователя
  - Группировка заказов для выдачи

## 🛠️ Технологический стек

### Frontend
| Технология | Версия | Назначение |
|-----------|---------|------------|
| Flutter | 3.0+ | Кроссплатформенная разработка |
| Provider | 6.0+ | Управление состоянием |
| Dio | 5.0+ | HTTP-запросы с прогрессом |
| Package Info Plus | 4.0+ | Информация о версии |
| URL Launcher | 6.0+ | Открытие ссылок |
| Shared Preferences | 2.0+ | Локальное хранение |
| Path Provider | 2.0+ | Работа с файловой системой |
| Open File | 3.0+ | Открытие файлов |
| Permission Handler | 11.0+ | Управление разрешениями |

### Backend
| Технология | Версия | Назначение |
|-----------|---------|------------|
| Node.js | 18+ | Серверная платформа |
| Express | 4.18+ | Веб-фреймворк |
| PostgreSQL | 15+ | База данных |
| Prisma | 5.0+ | ORM |
| JWT | 9.0+ | Авторизация |
| Bcrypt | 5.0+ | Хеширование паролей |
| Axios | 1.4+ | HTTP-клиент |
| Helmet | 7.0+ | Безопасность |
| CORS | 2.8+ | Кросс-доменные запросы |
| Morgan | 1.10+ | Логирование |
| PM2 | 5.3+ | Процесс-менеджер |

### Внешние сервисы
- **ЮKassa** - платежная система (Shop ID: 1148812)
- **SMS Aero** - SMS-уведомления
- **Yandex Cloud** - хостинг и база данных

## 🚀 Инфраструктура и развертывание

### Сервер
- **Провайдер**: Yandex Cloud
- **IP**: 84.201.149.245
- **OS**: Ubuntu 22.04 LTS
- **Характеристики**: 4GB RAM, 2 vCPU, 50GB SSD

### Endpoints
| Сервис | URL |
|--------|-----|
| Backend API | http://84.201.149.245:3000/api |
| Web App | http://84.201.149.245:3000/app |
| Admin Panel | http://84.201.149.245:3000/admin |
| APK Downloads | http://84.201.149.245:3000/downloads |
| Health Check | http://84.201.149.245:3000/health |

### Репозитории GitHub
- **Backend**: `github.com/idob23/severnaya-korzina-backend`
- **Mobile**: `github.com/idob23/severnaya_korzina`
- **Admin**: `github.com/idob23/severnaya_korzina_admin`

## 📋 База данных

### Основные таблицы
- **users** - пользователи системы
- **addresses** - адреса доставки
- **categories** - категории товаров
- **products** - товары
- **batches** - партии/закупки
- **batch_items** - товары в партиях
- **orders** - заказы
- **order_items** - позиции заказов

### Связи и ограничения
- Каскадное удаление для зависимых данных
- Ограничения на удаление активных сущностей
- Автоматическое обновление статистики

## 📱 Версионирование

### Текущие версии
| Компонент | Версия | Build |
|-----------|---------|-------|
| Mobile App | 1.2.0 | 12 |
| Web App | 6.12281441 | - |
| Admin Panel | 1.1.0 | - |
| Backend API | 1.1.0 | - |

### Система обновлений
- Автоматическая проверка версий
- OTA обновления для Android
- Принудительные обновления при критических изменениях
- Changelog для каждой версии

## 🔐 Безопасность

### Реализованные меры
- JWT токены с истечением срока
- Хеширование паролей (bcrypt)
- HTTPS для продакшена
- Helmet для защиты заголовков
- CORS политики
- Rate limiting для API
- Валидация входных данных
- Защита от SQL-инъекций (Prisma)

## 📈 Метрики проекта

### Использование
- **Зарегистрированных пользователей**: 100+
- **Активных закупок в месяц**: 2-3
- **Средний чек**: 3000-5000 ₽
- **Конверсия в заказ**: ~40%
- **Экономия для пользователей**: до 50%

### Производительность
- **Время ответа API**: <100ms
- **Uptime**: 99.9%
- **Размер APK**: ~35 MB
- **Размер Web App**: ~10 MB

## 🎉 Статус проекта

✅ **В ПРОДАКШЕНЕ с 03.01.2025**

Проект полностью готов и активно используется жителями Усть-Неры для организации коллективных закупок. Все основные функции реализованы, протестированы и работают в боевом режиме.

---

> 💡 **Контакты для связи**:
> - Email: sevkorzina@gmail.com
> - Телефон: +7 (914) 266-75-82
> - Адрес: Республика Саха (Якутия), пос. Усть-Нера